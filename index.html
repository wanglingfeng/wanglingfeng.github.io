<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Coding Note</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Coding Note">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Coding Note">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Coding Note">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Coding Note</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
        <!--<a id="nav-search-btn" class="nav-icon" title="搜索"></a>-->
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-swap配置笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/swap配置笔记/" class="article-date">
  <time datetime="2017-03-31T11:11:13.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/swap配置笔记/">swap配置笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="设置swap"><a href="#设置swap" class="headerlink" title="设置swap"></a>设置swap</h3><ol>
<li><code>dd if=/dev/zero of=/root/swap/tmp.swap bs=1M count=5120</code></li>
<li><code>mkswap /root/swap/tmp.swap</code></li>
<li><code>swapon /root/swap/tmp.swap</code></li>
<li>修改/etc/fstab文件，添加如下内容<br><code>/root/swap/tmp.swap swap swap defaults 0 0</code></li>
<li><code>swapon -s</code>或<code>free</code>或<code>cat /proc/swaps</code>查看</li>
</ol>
<h3 id="关闭swap"><a href="#关闭swap" class="headerlink" title="关闭swap"></a>关闭swap</h3><ol>
<li><code>swapoff /root/swap/tmp.swap</code></li>
<li>修改/etc/fstab文件</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/03/31/swap配置笔记/" data-id="cj0xqd8an002ksps616lv1wst" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-配置linux并发连接最大连接数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/配置linux并发连接最大连接数/" class="article-date">
  <time datetime="2017-03-31T11:07:41.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/配置linux并发连接最大连接数/">配置linux并发连接最大连接数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>linux机器默认的并发连接数大概为1000左右，高并发是难以支持的，所以要修改linux系统的各项参数</p>
<h3 id="设置open-files"><a href="#设置open-files" class="headerlink" title="设置open files"></a>设置open files</h3><p>查看open files：<code>unlimit -a</code></p>
<p>临时设置open files数：<code>ulimit -n [期望最大的open files数值]</code></p>
<p>永久设置open files数：/etc/security/limits.conf文件中添加如下两行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">* soft nofile 50000</div><div class="line">* hard nofile 50000</div></pre></td></tr></table></figure></p>
<p>PS：ubuntu系统不能用*，必须指定用户</p>
<h3 id="设置tcp优化"><a href="#设置tcp优化" class="headerlink" title="设置tcp优化"></a>设置tcp优化</h3><p>/etc/sysctl.conf文件中添加如下内容之后，执行sysctl -p启用配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">net.core.rmem_default = 256960</div><div class="line">net.core.rmem_max = 513920</div><div class="line">net.core.wmem_default = 256960</div><div class="line">net.core.wmem_max = 513920</div><div class="line">net.core.netdev_max_backlog = 2000</div><div class="line">net.core.somaxconn = 2048</div><div class="line">net.core.optmem_max = 81920</div><div class="line"></div><div class="line">net.ipv4.tcp_mem = 131072  262144  524288</div><div class="line">net.ipv4.tcp_rmem = 8760  256960  4088000</div><div class="line">net.ipv4.tcp_wmem = 8760  256960  4088000</div><div class="line">net.ipv4.tcp_keepalive_time = 1800</div><div class="line">net.ipv4.tcp_keepalive_intvl = 30</div><div class="line">net.ipv4.tcp_keepalive_probes = 3</div><div class="line">net.ipv4.tcp_sack = 1</div><div class="line">net.ipv4.tcp_fack = 1</div><div class="line">net.ipv4.tcp_timestamps = 1</div><div class="line">net.ipv4.tcp_window_scaling = 1</div><div class="line">net.ipv4.tcp_syncookies = 1</div><div class="line">net.ipv4.tcp_tw_reuse = 1</div><div class="line">net.ipv4.tcp_tw_recycle = 1</div><div class="line">net.ipv4.tcp_fin_timeout = 30</div><div class="line">net.ipv4.ip_local_port_range = 1024  65000</div><div class="line">net.ipv4.tcp_max_syn_backlog = 2048</div></pre></td></tr></table></figure></p>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>使用这个<a href="https://github.com/ideawu/c1000k" target="_blank" rel="external">c1000k</a>工具来测试你的系统最多支持多少并发连接.</p>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/03/31/配置linux并发连接最大连接数/" data-id="cj0xqd8ar002usps6fkm2iqrw" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-elasticsearch使用笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/elasticsearch使用笔记/" class="article-date">
  <time datetime="2017-03-31T11:04:04.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/elasticsearch/">elasticsearch</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/elasticsearch使用笔记/">elasticsearch使用笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="使用url"><a href="#使用url" class="headerlink" title="使用url"></a>使用url</h3><p>查询logstash信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://[your-node-name]:[your-port]/[your-index]/_search?pretty</div></pre></td></tr></table></figure></p>
<p>PS：url中的索引可以使用*号匹配</p>
<h3 id="使用命令"><a href="#使用命令" class="headerlink" title="使用命令"></a>使用命令</h3><p>curl命令取得指定index的统计结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --user [your-admin]:[your-password] http://[your-node-name]:[your-port]/[your-index]/_count?pretty</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/03/31/elasticsearch使用笔记/" data-id="cj0xqd894000csps64u8n7szq" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-screen命令使用笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/screen命令使用笔记/" class="article-date">
  <time datetime="2017-03-31T10:55:25.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/命令行/">命令行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/screen命令使用笔记/">screen命令使用笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="screen使用"><a href="#screen使用" class="headerlink" title="screen使用"></a>screen使用</h3><p>新建会话: screen<br>显示全部会话：screen -ls<br>通过screen列表中的pid重新登陆到分离的screen：screen -r [pid]</p>
<p>处于screen中，按Ctrl + a后,接</p>
<ul>
<li>d: 退出当前screen</li>
<li>w: 左下角显示有哪些会话</li>
<li>c: 新建会话</li>
<li>n: 移到下一个窗口</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/03/31/screen命令使用笔记/" data-id="cj0xqd8ab001tsps6nguzhcpb" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-item2-oh-my-zsh配置" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/31/item2-oh-my-zsh配置/" class="article-date">
  <time datetime="2017-03-31T10:43:48.000Z" itemprop="datePublished">2017-03-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/命令行/">命令行</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/31/item2-oh-my-zsh配置/">item2+oh-my-zsh配置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="安装iterm2后，使用以下命令安装oh-my-zsh"><a href="#安装iterm2后，使用以下命令安装oh-my-zsh" class="headerlink" title="安装iterm2后，使用以下命令安装oh my zsh"></a>安装iterm2后，使用以下命令安装oh my zsh</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl -L https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh | sh</div></pre></td></tr></table></figure>
<h3 id="待确定是否必要"><a href="#待确定是否必要" class="headerlink" title="待确定是否必要"></a>待确定是否必要</h3><p>.bash_profile文件添加以下内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">#enables colorin the terminal bash shell export</div><div class="line">export CLICOLOR=1</div><div class="line">#sets up thecolor scheme for list export</div><div class="line">export LSCOLORS=gxfxcxdxbxegedabagacad</div><div class="line">#sets up theprompt color (currently a green similar to linux terminal)</div><div class="line">export TERM=&apos;xterm-256color&apos;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/03/31/item2-oh-my-zsh配置/" data-id="cj0xqd89y0019sps65rqfvbhz" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-JVM内存模型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/24/JVM内存模型/" class="article-date">
  <time datetime="2017-02-24T09:57:09.000Z" itemprop="datePublished">2017-02-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/24/JVM内存模型/">JVM内存模型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="图解"><a href="#图解" class="headerlink" title="图解"></a>图解</h3><img src="/2017/02/24/JVM内存模型/jvm内存模型.jpg" alt="这是JVM内存模型" title="这是JVM内存模型">
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>生命周期都与线程相同</p>
<table>
<thead>
<tr>
<th style="text-align:left">名称</th>
<th style="text-align:center">特征</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">配置参数</th>
<th style="text-align:left">异常</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">程序计数器</td>
<td style="text-align:center">占用内存小，线程私有</td>
<td style="text-align:left">大致为字节码信号指示器</td>
<td style="text-align:left">无</td>
<td style="text-align:left">无</td>
</tr>
<tr>
<td style="text-align:left">虚拟机栈</td>
<td style="text-align:center">线程私有，使用连续的内存空间</td>
<td style="text-align:left">Java方法执行的内存模型，<br>存储局部变量表、操作栈、<br>动态链接、方法出口等信息</td>
<td style="text-align:left"><code>-Xss</code></td>
<td style="text-align:left">StackOverflowError<br>OutOfMemoryError</td>
</tr>
<tr>
<td style="text-align:left">堆</td>
<td style="text-align:center">线程共享，可以不使用连续的内存地址</td>
<td style="text-align:left">保存对象实例，所有对象实例<br>（包括数组）都要在堆上分配</td>
<td style="text-align:left"><code>-Xms</code><br><code>-Xsx</code><br><code>-Xmn</code></td>
<td style="text-align:left">OutOfMemoryError</td>
</tr>
<tr>
<td style="text-align:left">方法区</td>
<td style="text-align:center">线程共享，可以不使用连续的内存地址</td>
<td style="text-align:left">存储已被虚拟机加载的<br>类信息、常量、静态变量、<br>编译器即时编译后的代码等数据</td>
<td style="text-align:left"><code>-XX:PermSize:16M</code><br><code>-XX:MaxPermSize:64M</code></td>
<td style="text-align:left">OutOfMemoryError</td>
</tr>
<tr>
<td style="text-align:left">本地方法栈</td>
<td style="text-align:center">线程私有，使用连续的内存空间</td>
<td style="text-align:left">为虚拟机使用到的Native方法服务</td>
<td style="text-align:left">无</td>
<td style="text-align:left">StackOverflowError<br>OutOfMemoryError</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/02/24/JVM内存模型/" data-id="cj0xqd8860000sps61fv5ojax" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hashmap原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/22/hashmap原理/" class="article-date">
  <time datetime="2017-02-22T08:16:00.000Z" itemprop="datePublished">2017-02-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/22/hashmap原理/">hashmap原理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="实现原理"><a href="#实现原理" class="headerlink" title="实现原理"></a>实现原理</h3><p>拉链法：数组+链表<br>初始化根据初始容量创建对应数量的数组，每个元素储存的是一个链表的头结点。</p>
<h3 id="数组中index的算法"><a href="#数组中index的算法" class="headerlink" title="数组中index的算法"></a>数组中index的算法</h3><p>int表值范围从-2147483648到2147483648。前后加起来大概40亿的映射空间。HashMap扩容之前的数组初始大小才16。<br/><br>所以散列值不能直接拿来用，用之前还要先做对数组的长度取模运算，得到的余数才能用来访问数组下标。<br/><br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(tab.length - <span class="number">1</span>) &amp; hash <span class="comment">// 按位取并，作用上相当于取模mod或者取余%</span></div></pre></td></tr></table></figure></p>
<p>但是即使这样就算我的散列值分布再松散，要是只取最后几位的话，碰撞也会很严重。<br/><br>更要命的是如果散列本身做得不好，分布上成等差数列的漏洞，恰好使最后几个低位呈现规律性重复。这个使用就需要用到下面的一个函数”扰动函数”。<br/></p>
        
          <p class="article-more-link">
            <a href="/2017/02/22/hashmap原理/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/02/22/hashmap原理/" data-id="cj0xqd89k000usps6pqmsyyq1" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-jvm原理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/15/jvm原理/" class="article-date">
  <time datetime="2017-02-15T09:13:58.000Z" itemprop="datePublished">2017-02-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/15/jvm原理/">jvm原理</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="垃圾收集"><a href="#垃圾收集" class="headerlink" title="垃圾收集"></a>垃圾收集</h3><p>分代收集：根据对象的生命周期分为新生代和老年代。</p>
<ul>
<li>新生代 -&gt; 由于对象生命周期短，使用复制算法。新生代中分为Eden区和Survivor区，每次优先使用Eden区，如果Eden区满，将Eden区中存活的对象复制到Survivor区；如果Survivor区满，将Survivor区中存活的对象复制到老年代。</li>
<li>老年代 -&gt; 由于对象存活率高，使用标记-整理算法。扫描出存活的对象，回收未标记的对象，回收之后将存活的对象移动到同一端（不产生内存碎片）。</li>
</ul>
<h3 id="类的加载过程"><a href="#类的加载过程" class="headerlink" title="类的加载过程"></a>类的加载过程</h3><p>7个过程。</p>
<ul>
<li>加载：内存中生成java.lang.Class对象，加载到方法区，作为该类的访问入口。</li>
<li>验证：确保加载类的符合jvm规范，不会危害到jvm虚拟机。</li>
<li>准备：为静态变量分配内存并分配默认值，在方法区中进行分配。（static int i = 9，这时i的值为0，在初始化时值才为9）</li>
<li>解析：符号引用替换为直接引用。（String str=”s”，转化为str的地址指向”s”的地址）</li>
<li>初始化：执行构造函数，静态和非静态代码块。</li>
<li>使用：对象的属性或方法等调用操作。</li>
<li>卸载： jvm通过确定对象没有引用后进行gc操作。<br>简述：虚拟机把类从Class文件加载到内存中，并对数据进行校验，解析和初始化，形成虚拟机直接使用的java类型。</li>
</ul>
        
          <p class="article-more-link">
            <a href="/2017/02/15/jvm原理/#more">Read More</a>
          </p>
        
      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/02/15/jvm原理/" data-id="cj0xqd8a2001esps6mudlamt9" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-服务器端推送笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/10/服务器端推送笔记/" class="article-date">
  <time datetime="2017-02-10T08:31:03.000Z" itemprop="datePublished">2017-02-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/JAVA/">JAVA</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/10/服务器端推送笔记/">服务器端推送笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Server-Sent-Event-SSE"><a href="#Server-Sent-Event-SSE" class="headerlink" title="Server-Sent Event (SSE)"></a>Server-Sent Event (SSE)</h3><h4 id="运行过程"><a href="#运行过程" class="headerlink" title="运行过程"></a>运行过程</h4><p>浏览器通过HTTP向服务器发送请求，服务器拿到最新的数据，立即返回给客户端，客户端等待3秒后再次发出下一个请求。</p>
<h4 id="执行过程"><a href="#执行过程" class="headerlink" title="执行过程"></a>执行过程</h4><p>每3秒都会按照以下顺序执行<code>onopen -&gt; onmessage -&gt; onerror</code>，每次请求都会执行<code>onerror</code>方法，如果是正常关闭，<code>onerror</code>方法的回调参数readyState=3。</p>
<h4 id="Headers设置"><a href="#Headers设置" class="headerlink" title="Headers设置"></a>Headers设置</h4><p>ContentType必须设置为<code>text/event-stream</code></p>
<h4 id="封包内容"><a href="#封包内容" class="headerlink" title="封包内容"></a>封包内容</h4><p>Server端的程序推送给Client端的封包是由以下四部分构成，其格式为<code>字段名称:字段内容,字段名称:字段内容\n\n</code></p>
<ol>
<li>event: 事件或识别名称，默认值为message</li>
<li>data: 要传送给Client端的数据内容</li>
<li>id: Server端推送到Client端时的事件ID</li>
<li>retry: 用来定义两次要求之间的间隔时间，以毫秒为单位</li>
</ol>
<h3 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><ul>
<li>WebSocket可以看成是一种类似TCP/IP的socket技术；</li>
<li>此socket在Web应用中实现，浏览器和服务器只需要做一个握手的动作[借用http协议]，然后，浏览器和服务器之间就形成了一条快速通道。两者之间就直接可以数据互相传送。</li>
<li>WebSocket为应用层协议，其定义在TCP/IP协议栈之上。</li>
<li>WebSocket连接服务器的URI以”ws”[默认TCP端口为80]或者”wss”[默认TCP端口为443]开头。</li>
</ul>
<h4 id="运行过程-1"><a href="#运行过程-1" class="headerlink" title="运行过程"></a>运行过程</h4><p>客户端通知WebSockets服务器一个事件，服务器将立即通知消息；当任何新的未读消息来的时候，服务器都将立即返回数据给客户端。</p>
<h4 id="执行过程-1"><a href="#执行过程-1" class="headerlink" title="执行过程"></a>执行过程</h4><p>连接建立成功时，执行onOpen方法，收到客户端请求时执行onMessage方法，发生错误时执行onError方法，连接关闭时，执行onClose方法</p>
<h3 id="主要异同点"><a href="#主要异同点" class="headerlink" title="主要异同点"></a>主要异同点</h3><p>SSE：单向 | WebSocket：双向<br>SSE：轮询 | WebSocket：长连接</p>
<h3 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h3><h4 id="SSE"><a href="#SSE" class="headerlink" title="SSE"></a>SSE</h4><p>优点：服务器端开发很简单，服务器端支持已经统一。<br>缺点：浏览器需要不断的向服务器发出请求，然而HTTP request的header是非常长的，里面包含的有用数据可能只是一个很小的值，这样会占用很多的带宽。<br>实时性要求不高的情况下，推荐使用。</p>
<h4 id="webSocket"><a href="#webSocket" class="headerlink" title="webSocket"></a>webSocket</h4><p>优点：WebSocket协议中，为我们实现即时服务带来了两大好处：互相沟通的Header是很小的-大概只有2Bytes；服务器不再被动的接收到浏览器的request之后才返回数据，而是在有新数据时就主动推送给浏览器。<br>缺点：服务器长期维护长连接需要一定的成本，各个浏览器支持程度不一。<br>实时性要求高大情况下，推荐使用。</p>
<h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><p><a href="https://github.com/wanglingfeng/push-server-demo" target="_blank" rel="external">链接</a></p>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/02/10/服务器端推送笔记/" data-id="cj0xqd8ar002ssps6eizy786z" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-spring-mvc使用笔记" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/19/spring-mvc使用笔记/" class="article-date">
  <time datetime="2017-01-19T08:23:37.000Z" itemprop="datePublished">2017-01-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/技术/">技术</a>►<a class="article-category-link" href="/categories/技术/JAVA/">JAVA</a>►<a class="article-category-link" href="/categories/技术/JAVA/Spring/">Spring</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/19/spring-mvc使用笔记/">spring-mvc使用笔记</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Requestbody使用"><a href="#Requestbody使用" class="headerlink" title="@Requestbody使用"></a><code>@Requestbody</code>使用</h3><p>如果请求中缺少@Requestbody修饰的对象的某个字段，该字段值自动补为null，不会报错。</p>

      
    </div>
    <footer class="article-footer">
      <!--<a data-url="http://yoursite.com/2017/01/19/spring-mvc使用笔记/" data-id="cj0xqd8aj002dsps6v2gmhtel" class="article-share-link">Share</a>-->
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">&raquo;&raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/JAVA/">JAVA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/JAVA/Spring/">Spring</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/JAVA/Spring/spring-boot/">spring-boot</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/JAVA/对象使用/">对象使用</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/elasticsearch/">elasticsearch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/erlang/">erlang</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/gradle/">gradle</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/harbor/">harbor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/命令行/">命令行</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/存储/">存储</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/技术/存储/可视化工具/">可视化工具</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/服务发现/">服务发现</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/机器环境/">机器环境</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/消息队列/">消息队列</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/文章/">文章</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/03/31/swap配置笔记/">swap配置笔记</a>
          </li>
        
          <li>
            <a href="/2017/03/31/配置linux并发连接最大连接数/">配置linux并发连接最大连接数</a>
          </li>
        
          <li>
            <a href="/2017/03/31/elasticsearch使用笔记/">elasticsearch使用笔记</a>
          </li>
        
          <li>
            <a href="/2017/03/31/screen命令使用笔记/">screen命令使用笔记</a>
          </li>
        
          <li>
            <a href="/2017/03/31/item2-oh-my-zsh配置/">item2+oh-my-zsh配置</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Joseph Wang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    <script src="/js/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<!-- 返回顶部 -->
<div id="toTop">
	<a href="#">▲</a>
	<a href="#footer">▼</a>
</div>

<!-- fancybox -->

<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


  </div>
</body>
</html>
